{
  "master_md_path": "prd.md",
  "state_path": ".auto_state.json",
  "log_path": "auto_master.log",
  "chunk_strategy": "fixed_lines",
  "chunk_size_lines": 120,
  "wait_seconds": 60,
  "max_parallel_chats": 1,
  "min_length_ratio_ok": 0.9,
  "cursor_driver_path": "cursor_driver.scpt",
  "use_cursor_driver": false,
  "growth": {
    "target_line_count": 100000,
    "max_passes": 50,
    "max_chunks_per_pass": 20,
    "rebuild_state_each_pass": true,
    "stop_when_all_done": true
  },
  "git": {
    "enable_auto": false,
    "remote_name": "origin",
    "branch_name": "main",
    "auto_add_paths": [
      "prd.md",
      "auto_config.json",
      "auto_master.py",
      "auto_master.sh",
      "cursor_driver.scpt",
      ".auto_state.json",
      "auto_master.log",
      ".gitignore",
      "LICENSE",
      "README.md"
    ],
    "commit_prefix": "[AUTO-PRD]",
    "commit_after_each_pass": true,
    "push_after_each_pass": false,
    "pull_before_sync": true
  },
  "safety": {
    "enable_doctor_auto_fixes": false,
    "max_consecutive_failures": 5,
    "stop_on_invariant_violation": true,
    "doctor_scan_log_lines": 5000,
    "allow_config_autofix": false
  },
  "implementation": {
    "enabled": false,
    "primary_target_type": "web",
    "primary_language": "typescript",
    "primary_framework": "nextjs",
    "project_root": ".",
    "source_dir": "src",
    "generated_dir": "src/generated",
    "test_dir": "tests",
    "impl_plan_section_id": "5. IMPLEMENTATION & ENGINEERING NOTES",
    "impl_tasks_section_id": "9. TASKS, BACKLOG & ROADMAP",
    "impl_max_files_per_phase": 5,
    "impl_allow_overwrite_generated": true,
    "impl_never_overwrite_manual": true,
    "default_roles_for_impl": [
      "Principal Software Architect",
      "Senior Mobile Developer",
      "Full-Stack Web Developer",
      "AI/ML Engineer",
      "DevOps & Cloud Architect"
    ]
  },
  "profiles": {
    "default_profile": "hands_free_local",
    "profiles": {
      "hands_free_local": {
        "description": "Local development with full automation and Cursor integration",
        "can_run_shell": true,
        "can_edit_files": true,
        "can_use_cursor_driver": true,
        "requires_git": false,
        "requires_cursor": false,
        "risk_level": "low",
        "auto_run_doctor_before_start": true,
        "auto_plan_impl_after_grow": false,
        "auto_impl_loop_after_plan": false,
        "auto_git_sync_after_changes": false,
        "command_execution_mode": "direct",
        "file_edit_mode": "direct"
      },
      "hands_free_no_cursor": {
        "description": "Local development with full automation but no Cursor driver",
        "can_run_shell": true,
        "can_edit_files": true,
        "can_use_cursor_driver": false,
        "requires_git": false,
        "requires_cursor": false,
        "risk_level": "low",
        "auto_run_doctor_before_start": true,
        "auto_plan_impl_after_grow": false,
        "auto_impl_loop_after_plan": false,
        "auto_git_sync_after_changes": false,
        "command_execution_mode": "direct",
        "file_edit_mode": "direct"
      },
      "assistive_read_only": {
        "description": "Read-only assistance mode, suggests commands but doesn't execute",
        "can_run_shell": false,
        "can_edit_files": false,
        "can_use_cursor_driver": false,
        "requires_git": false,
        "requires_cursor": false,
        "risk_level": "none",
        "auto_run_doctor_before_start": false,
        "auto_plan_impl_after_grow": false,
        "auto_impl_loop_after_plan": false,
        "auto_git_sync_after_changes": false,
        "command_execution_mode": "suggest",
        "file_edit_mode": "suggest"
      },
      "semi_automatic": {
        "description": "Semi-automatic mode, requires confirmation for major operations",
        "can_run_shell": true,
        "can_edit_files": true,
        "can_use_cursor_driver": false,
        "requires_git": false,
        "requires_cursor": false,
        "risk_level": "low",
        "auto_run_doctor_before_start": true,
        "auto_plan_impl_after_grow": false,
        "auto_impl_loop_after_plan": false,
        "auto_git_sync_after_changes": false,
        "command_execution_mode": "confirm",
        "file_edit_mode": "confirm"
      }
    }
  },
  "domain_packs": {
    "enabled": true,
    "default_pack": "generic_app",
    "packs": {
      "generic_app": {
        "description": "Default pack for general-purpose apps (mobile/web/backend).",
        "primary_target_type": "multi",
        "suggested_roles": [
          "Chief Product Officer (CPO)",
          "Principal Software Architect",
          "Senior Mobile Developer",
          "Full-Stack Web Developer",
          "AI/ML Engineer",
          "DevOps & Cloud Architect"
        ],
        "suggested_stack": {
          "mobile": "React Native or Flutter",
          "web": "React/Next.js",
          "backend": "Node.js or Python/FastAPI"
        },
        "default_phase_patterns": ["MVP_CORE", "AUTH", "SETTINGS"],
        "default_impl_tracks": ["Client", "Backend", "AI", "Infra"]
      },
      "mobile_app": {
        "description": "Mobile-first apps (iOS/Android) with native-feel UI.",
        "primary_target_type": "mobile",
        "suggested_roles": [
          "Chief Product Officer (CPO)",
          "Senior Mobile Developer",
          "UI/UX Lead Designer",
          "AI/ML Engineer"
        ],
        "suggested_stack": {
          "mobile": "React Native or Flutter"
        },
        "default_phase_patterns": ["MVP_CORE", "AUTH", "PUSH_NOTIFICATIONS", "OFFLINE_MODE"],
        "default_impl_tracks": ["Client", "Backend", "AI"]
      },
      "web_app": {
        "description": "Web-first apps or SaaS dashboards.",
        "primary_target_type": "web",
        "suggested_roles": [
          "Chief Product Officer (CPO)",
          "Full-Stack Web Developer",
          "UI/UX Lead Designer",
          "DevOps & Cloud Architect"
        ],
        "suggested_stack": {
          "web": "Next.js or similar",
          "backend": "Node.js/Express or Python/FastAPI"
        },
        "default_phase_patterns": ["MVP_CORE", "AUTH", "ANALYTICS", "BILLING"],
        "default_impl_tracks": ["Client", "Backend", "Data"]
      },
      "game_2d": {
        "description": "2D game (mobile/desktop/web) with core loop, levels, and monetization.",
        "primary_target_type": "game",
        "suggested_roles": [
          "Lead Game Producer",
          "Gameplay Programmer",
          "Level Designer (Game)",
          "Technical Artist (Tech Art)"
        ],
        "suggested_stack": {
          "engine": "Unity or Godot"
        },
        "default_phase_patterns": ["CORE_LOOP", "LEVELS", "UI", "MONETIZATION"],
        "default_impl_tracks": ["Gameplay", "Art/Assets", "Backend (optional)"]
      },
      "ai_tool": {
        "description": "AI-powered assistant, generator, or automation tool.",
        "primary_target_type": "ai_tool",
        "suggested_roles": [
          "AI/ML Engineer",
          "Data Scientist & Analyst",
          "DevOps & Cloud Architect"
        ],
        "suggested_stack": {
          "backend": "Python/FastAPI or Node.js",
          "ai": "LLM API integration"
        },
        "default_phase_patterns": ["MVP_CORE", "AI_INTEGRATION", "SAFETY_GUARDS", "LOGGING"],
        "default_impl_tracks": ["Backend", "AI", "Infra"]
      }
    }
  },
  "deployment": {
    "enabled": true,
    "environments": {
      "local": {
        "description": "Developer local environment (no remote deployment).",
        "type": "local",
        "auto_deploy": false,
        "requires_ci": false,
        "requires_approval": false
      },
      "preview": {
        "description": "Auto-built preview for feature branches or PRs.",
        "type": "preview",
        "auto_deploy": false,
        "requires_ci": true,
        "requires_approval": false
      },
      "staging": {
        "description": "Shared pre-production environment for final testing.",
        "type": "staging",
        "auto_deploy": false,
        "requires_ci": true,
        "requires_approval": true
      },
      "production": {
        "description": "Primary production environment for real users.",
        "type": "production",
        "auto_deploy": false,
        "requires_ci": true,
        "requires_approval": true
      }
    },
    "default_environment": "local",
    "ci_system": "generic",
    "deploy_strategy": "manual_hooks",
    "deploy_hooks": {
      "build_command": "npm run build",
      "test_command": "npm test",
      "lint_command": "npm run lint",
      "package_command": null,
      "deploy_command_template": "echo 'Deploy to {env}'",
      "rollback_command_template": null,
      "health_check_command": null
    },
    "monitoring": {
      "enabled": true,
      "log_sources": ["auto_master.log"],
      "metrics_sources": [],
      "alert_policy": "manual_review",
      "basic_thresholds": {
        "max_error_rate_percent": 5,
        "max_failed_deploys": 3,
        "min_deploy_interval_minutes": 15
      }
    }
  },
  "security": {
    "enabled": true,
    "data_classification": {
      "levels": ["public", "internal", "sensitive", "restricted"],
      "default_level": "internal",
      "require_classification": false
    },
    "authn_authz": {
      "required": true,
      "preferred_flows": ["email_password", "oauth2", "social_login"],
      "allow_anonymous_usage": false,
      "session_management": "required",
      "password_policy": {
        "min_length": 8,
        "require_complexity": true
      }
    },
    "compliance": {
      "regimes": [],
      "app_store_policies": true,
      "logging_pii": "forbid",
      "data_retention_days": 365,
      "require_privacy_policy": true,
      "require_terms_of_service": true
    },
    "testing": {
      "enabled": true,
      "unit_tests_required": true,
      "integration_tests_recommended": true,
      "security_tests_recommended": true,
      "test_command": "npm test",
      "test_coverage_threshold": 70
    },
    "code_scanning": {
      "enabled": false,
      "tools": [],
      "run_on_ci_only": true,
      "fail_on_critical": true
    },
    "secrets_management": {
      "enabled": true,
      "allowed_locations": ["env_vars", "secret_manager"],
      "forbidden_locations": ["prd.md", "auto_master.log", "source_code_plaintext", "git_history"],
      "rotation_policy": "recommended"
    },
    "input_validation": {
      "required": true,
      "sanitize_all_inputs": true,
      "rate_limiting": "recommended"
    },
    "transport_security": {
      "require_https": true,
      "enforce_tls_version": "1.2+",
      "certificate_validation": "required"
    }
  },
  "performance": {
    "enabled": true,
    "ai_usage": {
      "max_tokens_per_call": 8000,
      "max_calls_per_run": 200,
      "soft_budget_tokens_per_day": 500000,
      "enforce_limits": false,
      "track_usage": true
    },
    "chunking_tuning": {
      "min_chunk_lines": 50,
      "max_chunk_lines": 400,
      "adaptive_chunking": true,
      "target_latency_seconds_per_chunk": 30,
      "prefer_larger_chunks": false
    },
    "growth_tuning": {
      "max_passes_per_run": 3,
      "max_chunks_per_pass": 10,
      "min_growth_ratio": 0.95,
      "max_growth_ratio": 1.5,
      "stop_if_slow": true,
      "slow_threshold_seconds_per_chunk": 60
    },
    "impl_tuning": {
      "max_files_per_impl_phase": 5,
      "max_impl_tasks_per_run": 10,
      "avoid_touching_large_files_over_kb": 200,
      "prefer_small_batches": true
    },
    "build_runtime": {
      "build_timeout_seconds": 900,
      "test_timeout_seconds": 600,
      "monitor_build_time": true,
      "warn_if_build_slow": true,
      "slow_build_threshold_seconds": 300
    },
    "cost_notes": {
      "track_ai_usage": true,
      "estimate_costs": false,
      "cost_per_1k_tokens_usd": null,
      "log_cost_estimates": false
    }
  },
  "analytics": {
    "enabled": true,
    "events": {
      "schema_version": 1,
      "core_events": [
        "app_open",
        "sign_up",
        "login",
        "logout",
        "feature_used",
        "purchase",
        "error",
        "feedback_submitted"
      ],
      "allow_custom_events": true,
      "require_event_documentation": true
    },
    "kpis": {
      "primary": [
        "daily_active_users",
        "weekly_active_users",
        "retention_d7",
        "conversion_rate"
      ],
      "secondary": [
        "feature_adoption_rate",
        "session_length",
        "error_rate"
      ],
      "custom": []
    },
    "experiments": {
      "enabled": true,
      "framework": "generic",
      "max_concurrent_experiments": 5,
      "require_hypothesis": true,
      "min_sample_size": 100
    },
    "feedback": {
      "enabled": true,
      "channels": [
        "in_app_feedback",
        "app_store_reviews",
        "email_support",
        "community_forum"
      ],
      "auto_summarize_feedback": true,
      "feedback_review_frequency": "weekly"
    },
    "storage": {
      "event_store_type": "unspecified",
      "retention_days": 365,
      "anonymize_pii": true
    },
    "privacy": {
      "respect_opt_out": true,
      "minimal_data_collection": true,
      "compliance_aware": true
    }
  },
  "extensions": {
    "enabled": true,
    "allow_custom_scripts": true,
    "document_custom_scripts_in_prd": true,
    "extension_directories": [
      "tools",
      "scripts"
    ],
    "known_extensions": [],
    "ai_tools": {
      "allow_agent_specific_profiles": true,
      "allow_external_orchestrators": true,
      "allow_custom_meta_prompts": true
    },
    "versioning": {
      "extension_versioning_scheme": "project_specific",
      "require_extension_documentation": true
    }
  },
  "ai": {
    "enabled": true,
    "default_provider": "cursor",
    "default_model": "auto",
    "providers": {
      "cursor": {
        "type": "ide_assistant",
        "description": "Local IDE agent (Cursor) used for code + PRD tasks",
        "supports_prd_growth": true,
        "supports_code_generation": true,
        "supports_evaluation": true,
        "supports_refactoring": true,
        "supports_background": false,
        "requires_ide": true,
        "cost_model": "included_in_ide"
      },
      "openai": {
        "type": "api",
        "description": "Remote LLM provider (OpenAI-compatible API)",
        "supports_prd_growth": true,
        "supports_code_generation": true,
        "supports_evaluation": true,
        "supports_refactoring": true,
        "supports_background": true,
        "requires_ide": false,
        "cost_model": "per_token",
        "api_base_url": null,
        "model_preferences": {
          "prd_growth": "gpt-4",
          "code_generation": "gpt-4",
          "evaluation": "gpt-4",
          "refactoring": "gpt-3.5-turbo"
        }
      },
      "anthropic": {
        "type": "api",
        "description": "Remote LLM provider (Anthropic Claude API)",
        "supports_prd_growth": true,
        "supports_code_generation": true,
        "supports_evaluation": true,
        "supports_refactoring": true,
        "supports_background": true,
        "requires_ide": false,
        "cost_model": "per_token",
        "api_base_url": null,
        "model_preferences": {
          "prd_growth": "claude-3-opus",
          "code_generation": "claude-3-sonnet",
          "evaluation": "claude-3-opus",
          "refactoring": "claude-3-sonnet"
        }
      },
      "local_llm": {
        "type": "local",
        "description": "Local model for offline or privacy-sensitive use",
        "supports_prd_growth": true,
        "supports_code_generation": false,
        "supports_evaluation": false,
        "supports_refactoring": true,
        "supports_background": false,
        "requires_ide": false,
        "cost_model": "free",
        "model_path": null,
        "api_endpoint": null
      },
      "google_agent": {
        "type": "ide_assistant",
        "description": "Google AI agent (antigravity) for IDE integration",
        "supports_prd_growth": true,
        "supports_code_generation": true,
        "supports_evaluation": true,
        "supports_refactoring": true,
        "supports_background": false,
        "requires_ide": true,
        "cost_model": "included_in_ide"
      },
      "none": {
        "type": "stub",
        "description": "No AI provider - all operations run in stub mode",
        "supports_prd_growth": false,
        "supports_code_generation": false,
        "supports_evaluation": false,
        "supports_refactoring": false,
        "supports_background": false,
        "requires_ide": false,
        "cost_model": "free"
      }
    },
    "task_routing": {
      "prd_growth": {
        "preferred_provider": "cursor",
        "fallback_providers": ["openai", "anthropic", "local_llm"],
        "model_preference": "auto"
      },
      "code_generation": {
        "preferred_provider": "cursor",
        "fallback_providers": ["openai", "anthropic"],
        "model_preference": "auto"
      },
      "evaluation": {
        "preferred_provider": "openai",
        "fallback_providers": ["anthropic", "cursor", "local_llm"],
        "model_preference": "auto"
      },
      "refactoring": {
        "preferred_provider": "cursor",
        "fallback_providers": ["openai", "anthropic", "local_llm"],
        "model_preference": "auto"
      },
      "documentation": {
        "preferred_provider": "cursor",
        "fallback_providers": ["local_llm", "openai"],
        "model_preference": "auto"
      }
    },
    "execution_modes": {
      "allow_ide_only": true,
      "allow_api_calls": false,
      "allow_local_models": false,
      "require_human_approval_for_api": true,
      "prefer_offline": false
    },
    "fallback_strategy": {
      "on_provider_unavailable": "try_fallback",
      "on_all_providers_unavailable": "stub_mode",
      "stub_mode_behavior": "log_and_continue"
    }
  },
  "sandbox": {
    "enabled": false,
    "notes": "Optional playground for experimental behaviors.",
    "allow_experimental_commands": false,
    "experimental_flags": {
      "alt_chunking": false,
      "aggressive_growth": false,
      "auto_git_experiments": false,
      "custom_ai_routing": false
    }
  }
}

